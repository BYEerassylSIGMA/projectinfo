<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Текстовый редактор с Pyodide</title>
    <script src="https://cdn.jsdelivr.net/npm/pyodide@0.23.4/pyodide.js"></script>
</head>
<body>
    <h1>Редактор текста с Pyodide</h1>
    <form id="wordForm">
        <label for="wordInput">Введите слово:</label>
        <input type="text" id="wordInput" required>
        <button type="submit">Обновить текст</button>
    </form>
    <div id="result"></div>

    <script>
        // Функция загрузки Pyodide
        async function loadPyodideAndRun() {
            await loadPyodide();  // Загружаем Pyodide
        }

        // Инициализация Pyodide
        loadPyodideAndRun();

        // Текущий текст, который будет обновляться
        let text = "Это простой текст. Тут есть несколько слов.";

        // Функция для обновления текста
        async function updateText(word) {
            // Запуск Python кода в Pyodide
            const pythonCode = `
import re
def update_text(text, word):
    if word in text:
        updated_text = re.sub(rf'({re.escape(word)})', r'$$\1$$', text)
        return updated_text
    else:
        return text
update_text('${text}', '${word}')
            `;
            const updatedText = await pyodide.runPython(pythonCode);  // Запуск Python кода

            return updatedText;
        }

        // Обработка отправки формы
        document.getElementById('wordForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const word = document.getElementById('wordInput').value;  // Получаем введённое слово
            const updatedText = await updateText(word);  // Обновляем текст с использованием Pyodide

            document.getElementById('result').innerText = updatedText;  // Выводим результат на страницу
        });
    </script>
</body>
</html>
